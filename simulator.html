<!DOCTYPE html>
<html>
<head>
  <style type="text/css">
    #rotor {
      width: 500px;
      height: 500px;
    }

    #arrow {
      transform-origin: 250px 250px;
      transition: transform 1s;
    }

    #negative-sensor {
      transform-origin: 250px 250px;
      transition: transform 1s;
    }

    #positive-sensor {
      transform-origin: 250px 250px;
      transition: transform 1s;
    }
  </style>
</head>
<body>
  <script type="text/javascript">
    var ws = new WebSocket("ws://" + window.location.hostname + ":2345");
    ws.onopen = function(event) {
      ws.send("Can you hear me?"); 
    };
    ws.onmessage = function(event) {
      console.log(event.data);
      rotorToBearing(JSON.parse(event.data).bearing);
    };
  </script>
  <svg id="rotor"
       xmlns="http://www.w3.org/2000/svg"
       xmlns:svg="http://www.w3.org/2000/svg"
       xmlns:xlink="http://www.w3.org/1999/xlink"
       width="500"
       height="500"
       version="1.1"
  >
    <circle style="fill: none; stroke: #aaaaee; stroke-width: 10"
            cx="250"
            cy="250"
            r="200"
    />
    <!-- 70 * tan(60deg.) = 121.243557 -->
    <path
      id="arrow"
      d="m 215,180 v 140 h 70 v -140 h 35 l -70,-121.243557 l -70,121.243557"
    />
    <rect
      id="negative-sensor"
      style="fill: #ff0000"
      x="240"
      y="35"
      width="20"
      height="30"
    />
    <rect id="positive-sensor"
          style="fill: #00ff00"
          x="240"
          y="35"
          width="20"
          height="30"
    />
  </svg>
  <script type="text/javascript">
    function rotorToBearing(bearing) {
        document.getElementById('arrow').style.transform = "rotate(" + bearing + "rad)";
    }

    function negativeSensorToBearing(bearing) {
        document.getElementById('negative-sensor').style.transform = "rotate(" + bearing + "rad)";
    }

    function positiveSensorToBearing(bearing) {
        document.getElementById('positive-sensor').style.transform = "rotate(" + bearing + "rad)";
    }
  </script>
  <br />
  <button onclick="rotorToBearing(0)">Click to rotate to 0 rad</button>
  <br />
  <button onclick="rotorToBearing(Math.PI/2)">Click to rotate to PI/2 rad</button>
  <br />
  <button onclick="rotorToBearing(Math.PI)">Click to rotate to PI rad</button>
  <br />
  <button onclick="rotorToBearing(Math.PI * 3 / 2)">Click to rotate to 3PI/2 rad</button>
  <br />
  <br />
  <button onclick="positiveSensorToBearing(0)">Click to set positive sensor to 0 rad</button>
  <br />
  <button onclick="positiveSensorToBearing(Math.PI/2)">Click to set positive sensor to PI/2 rad</button>
  <br />
  <button onclick="positiveSensorToBearing(Math.PI)">Click to set positive sensor to PI rad</button>
  <br />
  <button onclick="positiveSensorToBearing(Math.PI * 3 / 2)">Click to set positive sensor to 3PI/2 rad</button>
  <br />
  <br />
  <button onclick="negativeSensorToBearing(0)">Click to set negative sensor to 0 rad</button>
  <br />
  <button onclick="negativeSensorToBearing(Math.PI/2)">Click to set negative sensor to PI/2 rad</button>
  <br />
  <button onclick="negativeSensorToBearing(Math.PI)">Click to set negative sensor to PI rad</button>
  <br />
  <button onclick="negativeSensorToBearing(Math.PI * 3 / 2)">Click to set negative sensor to 3PI/2 rad</button>
</body>
</html>
